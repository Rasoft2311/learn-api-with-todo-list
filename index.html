<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>NaN Blog</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <h1>My F*ucking TODO</h1>
  <div id="todos"></div>

<script>

  window.module = {};
  
  function getUserInfo(userId) {
      var xml = new XMLHttpRequest();
      xml.open("GET","http://localhost:3000/api/users/" + userId, true);
      xml.onload = function () {
          console.log("Request status code: " + xml.status + "; status text" + xml.statusText);
          if(xml.status>=200 && xml.status<300)
              console.log(JSON.parse(xml.responseText));
          else console.log("Problem here");
      };
      xml.send();
  }

  //getUserInfo(10);
  
  




  // Для того щоб отримати список todo'шок для конкретного користувача
  function getTodoList (userId) {
    var xml = new XMLHttpRequest()
    xml.open('GET', 'http://localhost:3000/api/todos?userId=' + userId, true)
    xml.onload = function () {
      console.log('Request status code: ', xml.status, '; status text: ', xml.statusText)
      if (xml.status >= 200 && xml.status < 300) {
        console.log(JSON.parse(xml.responseText))
      } else {
        console.log('Something went wrong :(')
      }
    }
    xml.send()
  }

  getTodoList(9);

  function createTodo (todo) {
    var xml = new XMLHttpRequest()
    // Використовуємо POST метод оскільки ми хочемо створити новий об'єкт у базі даних,
    // А ще ми не вказуємо id нашого todo, як ми це робили для запиту GET http://localhost:3000/api/todos/200
    // бо у випадку створення нової todo'шки бекенд сам створить id.
    xml.open('POST', 'http://localhost:3000/api/todos', true)
    // Важливо вказати, якого типу ми будемо надсилати дані на сервер
    // У нашому випадку це буде JSON, який ми передаємо при виклику методу xml.send(...)
    xml.setRequestHeader('Content-Type', 'application/json; charset=utf-8')
    xml.onload = function () {
      console.log('Request status code: ', xml.status, '; status text: ', xml.statusText)
      if (xml.status >= 200 && xml.status < 300) {
        console.log(JSON.parse(xml.responseText))
      } else {
        console.log('Something went wrong :(')
      }
    }
    xml.send(JSON.stringify(todo))
  }


  function createTodoExample () {
    createTodo({
      userId: 10,
      title: 'Call to mom',
      completed: false
    })
  }

  //createTodoExample();
  
  function deleteTodo(todoId) {
      var xml = new XMLHttpRequest();
      xml.open("DELETE", "http://localhost:3000/api/todos/" + todoId, true);
      xml.onload = function () {
          console.log('Request status code: ', xml.status, '; status text: ', xml.statusText);
          if(xml.status>=200 && xml.status<300)
              console.log(JSON.parse(xml.responseText));
          else console.log("problems here");
      };
      xml.send();
  }

  //deleteTodo(184);



</script>

  <script src="js/todoView.js"></script>
  <script src="js/todoModel.js"></script>
  <script src="js/todoController.js"></script>
  <script src="js/todosView.js"></script>
  <script src="js/todosModel.js"></script>
  <script src="js/todosController.js"></script>
  <script src="js/app.js"></script>
</body>
</html>